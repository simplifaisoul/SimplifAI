# Security Headers and CSP Configuration
# This file contains security headers for enhanced website security

# Content Security Policy
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://api.github.com https://jsonplaceholder.typicode.com https://www.google-analytics.com; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests; block-all-mixed-content

# X-Frame-Options
X-Frame-Options: DENY

# X-Content-Type-Options
X-Content-Type-Options: nosniff

# X-XSS-Protection
X-XSS-Protection: 1; mode=block

# Referrer Policy
Referrer-Policy: strict-origin-when-cross-origin

# Permissions Policy
Permissions-Policy: geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()

# Strict-Transport-Security (HTTPS only)
# Strict-Transport-Security: max-age=31536000; includeSubDomains; preload

# Feature Policy (deprecated, use Permissions Policy instead)
# Feature-Policy: geolocation 'none', microphone 'none', camera 'none'

# Additional Security Headers
X-Permitted-Cross-Domain-Policies: none
X-Download-Options: noopen
X-Robots-Tag: noarchive, nosnippet

# Cache Control for sensitive files
<FilesMatch "\.(log|txt|md|json|xml)$">
    <IfModule mod_headers.c>
        Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
        Header set Pragma "no-cache"
        Header set Expires "Thu, 1 Jan 1970 00:00:00 GMT"
    </IfModule>
</FilesMatch>

# Protect sensitive files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

<FilesMatch "(^#.*#|.(bak|config|dist|fla|inc|ini|log|psd|sh|sql|swp)|~)$">
    Require all denied
</FilesMatch>

# Prevent access to configuration files
<FilesMatch "^(wp-config|config|database|\.env).*">
    Require all denied
</FilesMatch>

# Secure file uploads
<FilesMatch "\.(php|phtml|php3|php4|php5|pl|py|cgi|sh|exe)$">
    Require all denied
</FilesMatch>

# Disable directory listing
Options -Indexes

# Disable server signature
ServerSignature Off

# Limit request size to prevent DoS attacks
LimitRequestBody 10485760

# Limit request fields to prevent DoS attacks
LimitRequestFields 100

# Limit request line size to prevent DoS attacks
LimitRequestLine 8190

# Prevent HTTP 1.0 attacks
RequestReadTimeout header=20-40,MinRate=500 body=10,MinRate=500

# Enable clickjacking protection
Header always set X-Frame-Options DENY

# Enable XSS protection
Header always set X-XSS-Protection "1; mode=block"

# Prevent MIME type sniffing
Header always set X-Content-Type-Options nosniff

# Control referrer information
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# HSTS (uncomment when HTTPS is available)
# Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"